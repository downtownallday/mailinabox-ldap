<form>

  <error-msgs ref="error_msgs" v-if="error_handler === null"></error-msgs>
  
  <!-- TOTP code input -->
  <div v-if="login_step=='missing-totp-token'" class="form-group pr-5">
    
    <div class="font-italic mt-2">
      Your account requires additional authentication
    </div>
    
    <div class="pl-5 pr-5 mt-4">
      <div>Enter the six-digit code generated by your two-factor authentication app</div>
      <div><input type="text" class="form-control w-50" v-model="totp_token" maxlength="12" @keydown="error_ref.hide_errors()"></div>
      <div><small class="form-text text-muted">6-digit code</small></div>
      
      <div v-if="login_help && login_help.length > 0" class="mt-2">
        Check these places:
        <div v-for="label in login_help" class="pl-1">
          <div>{{label}}</div>
        </div>
      </div>
    </div>
  </div>
    
    
  <!-- username / password input -->
  <div v-else>
    <div class="font-italic mt-2">
      {{ login_message }}
    </div>
    
    <div class="pl-4 pr-4 mt-4">
      <div class="form-group">
        <div>Enter your email address</div>
        <div><input type="email" class="form-control" aria-describedby="emailHelp" v-model="username" @keydown="error_ref.hide_errors()"></div>
        <div><small id="emailHelp" class="form-text text-muted">This is your Mail-In-A-Box email address</small></div>
      </div>
      
      <div class="form-group">
        <div>Password</div>
        <div><input type="password" class="form-control" v-model="password" @keydown="error_ref.hide_errors()" aria-describedby="passwordHelp"></div>
        <div><small id="passwordHelp" class="form-text text-muted">This is your email password</small></div>
      </div>

      <div class="form-group">
        <label class="mb-0">
          <input type="checkbox" class="ml-1 mr-1" v-model="stay_signed_in">
          Keep me signed in
        </label>
      </div>
      
    </div>
  </div>
  
  <!-- login & consent button -->
  <div class="text-center mt-2">
    <button class="btn btn-outline-primary" style="min-width:8rem" @click.prevent="do_login"> Login </button>
  </div>
  
</form>

